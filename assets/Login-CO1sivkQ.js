import{d as q,r as w,c as F,a as M,b as I,e as E,f as p,g as o,w as l,h as g,o as z,u as B,i as f,E as V,_ as D}from"./index-DiN20nqF.js";const N=q("user",()=>{const i=w(null),d=w(localStorage.getItem("token")),_=F(()=>!!d.value);return{userInfo:i,token:d,isLoggedIn:_,login:async(t,a)=>new Promise(s=>{setTimeout(()=>{const k={id:1,username:t,email:`${t}@example.com`,avatar:"https://via.placeholder.com/100",role:"admin"};i.value=k,d.value="mock-jwt-token-"+Date.now(),localStorage.setItem("token",d.value),localStorage.setItem("isLoggedIn","true"),s()},500)}),logout:()=>{i.value=null,d.value=null,localStorage.removeItem("token"),localStorage.removeItem("isLoggedIn")},updateUserInfo:t=>{i.value&&(i.value={...i.value,...t})}}}),T={class:"login-container"},$={class:"login-form-wrapper"},j={class:"login-footer"},A={class:"dialog-footer"},G=M({__name:"Login",setup(i){const d=B(),_=N(),c=w(),v=w(),b=w(!1),t=w(!1),a=I({username:"",password:"",rememberMe:!1}),s=I({username:"",email:"",password:"",confirmPassword:""}),k={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}]},L={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(m,e,n)=>{e!==s.password?n(new Error("两次输入密码不一致")):n()},trigger:"blur"}]},R=async()=>{if(c.value)try{await c.value.validate(),b.value=!0,await _.login(a.username,a.password),V.success("登录成功"),d.push("/dashboard")}catch(m){V.error(m.message||"登录失败，请检查用户名和密码")}finally{b.value=!1}},S=async()=>{if(v.value)try{await v.value.validate(),await new Promise(m=>setTimeout(m,1e3)),V.success("注册成功，请登录"),t.value=!1,a.username=s.username}catch(m){V.error(m.message||"注册失败")}};return(m,e)=>{const n=g("el-input"),u=g("el-form-item"),C=g("el-checkbox"),y=g("el-link"),x=g("el-button"),U=g("el-form"),P=g("el-dialog");return z(),E("div",T,[p("div",$,[e[15]||(e[15]=p("div",{class:"login-header"},[p("h2",null,"Vue3 Data Dashboard"),p("p",null,"数据可视化管理平台")],-1)),o(U,{ref_key:"loginFormRef",ref:c,model:a,rules:k,"label-position":"left","label-width":"80px",class:"login-form"},{default:l(()=>[o(u,{label:"用户名",prop:"username"},{default:l(()=>[o(n,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=r=>a.username=r),placeholder:"请输入用户名","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),o(u,{label:"密码",prop:"password"},{default:l(()=>[o(n,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=r=>a.password=r),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",size:"large"},null,8,["modelValue"])]),_:1}),o(u,null,{default:l(()=>[o(C,{modelValue:a.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=r=>a.rememberMe=r)},{default:l(()=>[...e[10]||(e[10]=[f("记住我",-1)])]),_:1},8,["modelValue"]),o(y,{type:"primary",underline:!1,class:"forgot-password"},{default:l(()=>[...e[11]||(e[11]=[f(" 忘记密码？ ",-1)])]),_:1})]),_:1}),o(u,null,{default:l(()=>[o(x,{type:"primary",loading:b.value,onClick:R,size:"large",class:"login-btn"},{default:l(()=>[...e[12]||(e[12]=[f(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),p("div",j,[e[14]||(e[14]=p("span",null,"还没有账号？",-1)),o(y,{type:"primary",underline:!1,onClick:e[3]||(e[3]=r=>t.value=!0)},{default:l(()=>[...e[13]||(e[13]=[f(" 立即注册 ",-1)])]),_:1})])]),_:1},8,["model"])]),o(P,{modelValue:t.value,"onUpdate:modelValue":e[9]||(e[9]=r=>t.value=r),title:"用户注册",width:"400px",center:""},{footer:l(()=>[p("span",A,[o(x,{onClick:e[8]||(e[8]=r=>t.value=!1)},{default:l(()=>[...e[16]||(e[16]=[f("取消",-1)])]),_:1}),o(x,{type:"primary",onClick:S},{default:l(()=>[...e[17]||(e[17]=[f("注册",-1)])]),_:1})])]),default:l(()=>[o(U,{ref_key:"registerFormRef",ref:v,model:s,rules:L,"label-position":"left","label-width":"80px"},{default:l(()=>[o(u,{label:"用户名",prop:"username"},{default:l(()=>[o(n,{modelValue:s.username,"onUpdate:modelValue":e[4]||(e[4]=r=>s.username=r),placeholder:"请输入用户名","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),o(u,{label:"邮箱",prop:"email"},{default:l(()=>[o(n,{modelValue:s.email,"onUpdate:modelValue":e[5]||(e[5]=r=>s.email=r),placeholder:"请输入邮箱","prefix-icon":"Message"},null,8,["modelValue"])]),_:1}),o(u,{label:"密码",prop:"password"},{default:l(()=>[o(n,{modelValue:s.password,"onUpdate:modelValue":e[6]||(e[6]=r=>s.password=r),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(u,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[o(n,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[7]||(e[7]=r=>s.confirmPassword=r),type:"password",placeholder:"请确认密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),J=D(G,[["__scopeId","data-v-f67630dd"]]);export{J as default};
